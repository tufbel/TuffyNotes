## 1 基本命令

### 1.1 基础操作（增删改查）

```powershell
sudo su # 切换root账户  Ctrl+D返回原账户
su [name]  # 切换普通账户

pwd  # 查看当前路径
mkdir [文件夹]  # 创建一个文件夹
rm [-r] 文件  # 删除一个文件，带-r参数可删除文件夹
cp [name] [新]  # 复制文件
touch [name]  # 新建文件
mv [-b] [源文件或目录] [目标文件或目录] # 移动文件或重命名文件，-b参数代表覆盖

ls -a # 查看所有文件包括隐藏
find / -name [name] # 查找文件路径
locate [name]  # 查找文件路径
whereis name # 查找文件或者文件
```

### 1.2 压缩与解压

```shell
tar -xvf FileName.tar         # 解包
tar -cvf FileName.tar DirName  # 将DirName和其下所有文件（夹）打包
```

### 1.3 软连接

```shell
ln -s [源文件] [目标文件]
```



## 2 进程与端口命令

首先查看pid：

```shell
ps -ef | grep 进程名
```

通过pid查看占用端口：

```shell
netstat -nap | grep [name|pid]  # 可以查看到所有进程
netstat -ntlp| grep nginx  # 紧查看工作进程
```

查看使用某端口的进程：

```powershell
lsof -i:8000
netstat -ap|grep 8000  # p参数需要管理员权限
```

终止进程：

```powershell
kill -9  进程号
```



## 3 服务运行

### 3.1 Ubuntu

```shell
service [name] start/restart/stop  # 启动/重启/停止程序
service [name] status  # 查看服务状态
```

### 3.2 CentOS

```shell
systemctl start/restart/stop/status [name]  # 服务操作
systemctl enable [name] # CentOS开机启动服务
```



## 4 任务后台运行

**后台允许的jobs只在一个bash中生效，如果断开连接或关闭Terminal，则无法查询到其jobs的number。**

```shell
nohup [Command] &  # 后台运行命令，&表示挂起 这两个命令都能单独使用
[Command] &  # 后台运行但是显示输出，Ctrl+c不会终止运行
nohup [Command] # 运行任务但是不会看到输出，Ctrl+c会终止运行，非后台
eg:
(base) root@limiu:/opt/wFocus/wFocus nohup python manage.py runserver 0.0.0.0:8000 &
[1] 12348 ... & # 表示进程号12348 [1]是jobs的number

setsid ./test.sh & # setsid将其父进程改为init进程（进程号为1），也是不中断的后台运行
```

```shell
jobs -l # 查看所有在执行的命令
[bash] test.sh # 运行test.sh
```

- **Ctrl+c** 中断脚本运行
- **Ctrl+z** 切换到后台并暂停，退出当前shell终端，再重新打开，使用jobs看不到正在运行的test.sh，但使用ps -ef可以看到

```shell
bg number # 将后台暂停的脚本开始
fg %number  # 切换到前台
```

> 中断后台运行的test.sh脚本：先`fg %number`切换到前台，再`ctrl+c`；或是直接`kill %number`

## 5 更换软件安装源

### 5.1 CentOS

以**CentOS 7**为例

#### 备份

```shell
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
```

#### 下载

```shell
wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo
```

#### 修改配置

非阿里服务器在生成缓存时有可能会出现`[Errno 14] curl#6 - "Could not resolve host: mirrors.cloud.aliyuncs.com;`错误提示，但是不影响使用，可以进行如下配置：

```shell
sed -i -e '/mirrors.cloud.aliyuncs.com/d' -e '/mirrors.aliyuncs.com/d' /etc/yum.repos.d/CentOS-Base.repo
```

#### 清除和生成缓存

```shell
yum clean all
yum makecache
yum repolist # 查看当前源
```

